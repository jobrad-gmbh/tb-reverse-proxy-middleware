{
  "publicKeyPath": "",
  "privateKeyPath": "",
  "port": {
    "__evaluate__": "environment.PORT ?? 8080"
  },

  "forwarders": {
    "base": {
      "headerTransformations": {
        "send": [
            {
                "source": "/(GET|POST) \\/.* (.*)/",
                "target": "'$1 /services/data/v56/sobjects/Lead $2'"
            },
            {"target": "`Authorization: Bearer ${stateAPIs.salesforceSession.response.data.access_token}`"}
        ]
      },
      "stateAPIs": {
        "__append__": [
          {
            "data": {
              "score": 0.01,
              "secret": {
                "__evaluate__": "environment.GOOGLE_RECAPTCHA_KEY"
              },
              "skipSecret": {
                "__evaluate__": "environment.SKIP_SECRET"
              }
            },
            "expressions": {
              "pre": [
                "data.skipSecret === request.headers['jobrad-bypass-captcha-skip-secret'] ? 'break' : 'continue'",
                "request.headers['g-recaptcha-response'] ? true : 400"
              ],
              "post": [
                "Boolean(error)",
                "response.data.success",
                "typeof response.data.score === 'number' && response.data.score >= data.score ? true : 420"
              ]
            },
            "name": "googleReCaptchaV2-3",
            "url": "https://www.google.com/recaptcha/api/siteverify?secret=${data.secret}&response=${headers['g-recaptcha-response']}"
          },
          {
            "name": "salesforceSession",
            "options": {
              "body": {
                "grant_type": "password"
              },
              "method": "POST"
            },
            "expressions": {"pre": "true"}
          }
        ]
      }
    },
    "salesforceFreelancer": {
      "host": "jobradgmbh--leadform.sandbox.my.salesforce.com",
      "stateAPIs": {
        "__1__": {
          "options": {
            "body": {
              "client_id": "environment.FREELANCER_CLIENT_ID",
              "client_secret": "environment.FREELANCER_CLIENT_SECRET",
              "username": "environment.FREELANCER_USERNAME",
              "password": "environment.FREELANCER_PASSWORD"
            }
          }
        },
        "__2__": {
          "url": "https://jobradgmbh--leadform.sandbox.my.salesforce.com/services/oauth2/token"
        }
      },
      "useExpression": "false"
    },
    "salesforceSales": {
      "host": "jobradgmbh--leadform.sandbox.my.salesforce.com",
      "stateAPIs": {
        "__1__": {
          "options": {
            "body": {
              "client_id": "environment.SALES_CLIENT_ID",
              "client_secret": "environment.SALES_CLIENT_SECRET",
              "username": "environment.SALES_USERNAME",
              "password": "environment.SALES_PASSWORD"
            }
          }
        },
        "__2__": {
          "url": "https://jobradgmbh--leadform.sandbox.my.salesforce.com/services/oauth2/token"
        }
      },
      "useExpression": "true"
    }
  }
}
